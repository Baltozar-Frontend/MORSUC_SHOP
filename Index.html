<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <title>–ú–æ–π –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –î–∞—à–±–æ—Ä–¥</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .tg-badge {
            background: linear-gradient(135deg, #0088cc, #00aaff);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .tg-section {
            border: 2px solid #0088cc;
            background: linear-gradient(135deg, rgba(0, 136, 204, 0.1), rgba(0, 170, 255, 0.05));
        }
        
        .tg-data-item {
            background: rgba(0, 136, 204, 0.1);
            border-left: 4px solid #0088cc;
        }
        
        .permission-request {
            background: #fff8e1;
            border: 2px dashed #ffb300;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }
        
        .location-icon {
            color: #4CAF50;
            margin-right: 5px;
        }
        
        .permission-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .permission-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        
        .permission-btn.secondary {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }
        
        .permission-btn.danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }
        
        .hidden { display: none !important; }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            max-width: 400px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                <i class="fas fa-user-shield"></i> –ú–æ–π –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –î–∞—à–±–æ—Ä–¥
                <span id="tgBadge" class="tg-badge hidden">
                    <i class="fab fa-telegram"></i> Telegram Web App
                </span>
            </h1>
            <p class="subtitle">–í—Å—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏</p>
            
            <div id="permissionRequest" class="permission-request hidden">
                <p><i class="fas fa-map-marker-alt location-icon"></i> <strong>–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏</strong></p>
                <p>–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –≥–µ–æ–¥–∞–Ω–Ω—ã–º</p>
                <button onclick="requestLocationPermission()" class="permission-btn">
                    <i class="fas fa-location-dot"></i> –†–∞–∑—Ä–µ—à–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
                </button>
                <button onclick="getApproximateLocation()" class="permission-btn secondary">
                    <i class="fas fa-approximate-location"></i> –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
                </button>
            </div>
        </header>

        <div class="dashboard">
            <!-- Telegram Web App –¥–∞–Ω–Ω—ã–µ -->
            <section id="tgSection" class="card tg-section hidden">
                <div class="card-header">
                    <h2><i class="fab fa-telegram"></i> –î–∞–Ω–Ω—ã–µ Telegram Web App</h2>
                    <span class="tg-badge">–ë–æ—Ç –¥–∞–Ω–Ω—ã–µ</span>
                </div>
                <div class="info-grid" id="tgData">
                    <div class="info-item tg-data-item">
                        <span class="label">–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä:</span>
                        <span id="tgInitData" class="value">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="info-item tg-data-item">
                        <span class="label">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</span>
                        <span id="tgUserId" class="value">-</span>
                    </div>
                    <div class="info-item tg-data-item">
                        <span class="label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</span>
                        <span id="tgUsername" class="value">-</span>
                    </div>
                    <div class="info-item tg-data-item">
                        <span class="label">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è:</span>
                        <span id="tgFullName" class="value">-</span>
                    </div>
                    <div class="info-item tg-data-item">
                        <span class="label">–Ø–∑—ã–∫ Telegram:</span>
                        <span id="tgLanguage" class="value">-</span>
                    </div>
                    <div class="info-item tg-data-item">
                        <span class="label">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</span>
                        <span id="tgPlatform" class="value">-</span>
                    </div>
                    <div class="info-item tg-data-item">
                        <span class="label">–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:</span>
                        <span id="tgAppVersion" class="value">-</span>
                    </div>
                    <div class="info-item tg-data-item">
                        <span class="label">–•—ç—à:</span>
                        <span id="tgHash" class="value code">-</span>
                    </div>
                </div>
            </section>

            <!-- –°–µ–∫—Ü–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -->
            <section class="card">
                <div class="card-header">
                    <h2><i class="fas fa-mobile-alt"></i> –î–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</h2>
                    <button class="refresh-btn" onclick="refreshDeviceData()">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
                <div class="info-grid" id="deviceData">
                    <div class="info-item">
                        <span class="label">IP-–∞–¥—Ä–µ—Å:</span>
                        <span id="ip" class="value loading">–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ë—Ä–∞—É–∑–µ—Ä:</span>
                        <span id="browser" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–û–°:</span>
                        <span id="os" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞:</span>
                        <span id="screen" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–Ø–∑—ã–∫:</span>
                        <span id="language" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:</span>
                        <span id="timezone" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">JavaScript:</span>
                        <span id="js" class="value success">–î–∞ ‚úì</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Cookies:</span>
                        <span id="cookies" class="value">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                    </div>
                </div>
            </section>

            <!-- –°–µ–∫—Ü–∏—è —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π –∏ —Å–µ—Ç—å—é -->
            <section class="card">
                <div class="card-header">
                    <h2><i class="fas fa-map-marker-alt"></i> –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∏ —Å–µ—Ç—å</h2>
                    <div class="location-controls">
                        <button onclick="getExactLocation()" class="refresh-btn" title="–¢–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
                            <i class="fas fa-location-crosshairs"></i>
                        </button>
                        <button onclick="getApproximateLocation()" class="refresh-btn" title="–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ">
                            <i class="fas fa-map"></i>
                        </button>
                    </div>
                </div>
                <div class="info-grid" id="locationData">
                    <div class="info-item">
                        <span class="label">–¢–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</span>
                        <span id="exactLocation" class="value">
                            <button onclick="requestLocationPermission()" class="permission-btn small">
                                <i class="fas fa-location-dot"></i> –ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–æ—Å—Ç—É–ø
                            </button>
                        </span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ (–ø–æ IP):</span>
                        <span id="ipLocation" class="value">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ...</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</span>
                        <span id="coordinates" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–¢–æ—á–Ω–æ—Å—Ç—å:</span>
                        <span id="accuracy" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ü—Ä–æ–≤–∞–π–¥–µ—Ä (ISP):</span>
                        <span id="isp" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–û–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å:</span>
                        <span id="onlineStatus" class="value success">–û–Ω–ª–∞–π–Ω ‚úì</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</span>
                        <span id="connectionType" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏:</span>
                        <span id="pageLoadTime" class="value">-</span>
                    </div>
                </div>
            </section>

            <!-- –°–µ–∫—Ü–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö -->
            <section class="card">
                <div class="card-header">
                    <h2><i class="fas fa-microchip"></i> –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                    <button class="refresh-btn" onclick="refreshTechData()">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div class="info-grid" id="techData">
                    <div class="info-item">
                        <span class="label">User Agent:</span>
                        <span id="userAgent" class="value code">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</span>
                        <span id="platform" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ü–∞–º—è—Ç—å:</span>
                        <span id="memory" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–Ø–¥–µ—Ä CPU:</span>
                        <span id="cpuCores" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–ë–∞—Ç–∞—Ä–µ—è:</span>
                        <span id="battery" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">WebGL:</span>
                        <span id="webgl" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–í—Ä–µ–º—è:</span>
                        <span id="currentTime" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">–î–æ—Å—Ç—É–ø–Ω—ã–µ API:</span>
                        <span id="availableApis" class="value">-</span>
                    </div>
                </div>
            </section>

            <!-- –°–µ–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ -->
            <section class="card">
                <div class="card-header">
                    <h2><i class="fas fa-cloud-upload-alt"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤</h2>
                    <button class="refresh-btn" onclick="loadFiles()">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                
                <div class="upload-section">
                    <div class="file-input-container">
                        <input type="file" id="fileInput" multiple class="file-input">
                        <label for="fileInput" class="file-label">
                            <i class="fas fa-paperclip"></i> –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã
                        </label>
                    </div>
                    
                    <div class="upload-controls">
                        <button onclick="uploadFiles()" class="upload-btn">
                            <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å
                        </button>
                        <button onclick="clearFiles()" class="clear-btn">
                            <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                    </div>
                    
                    <div id="uploadProgress" class="progress-container hidden">
                        <div class="progress-bar">
                            <div id="progressFill" class="progress-fill"></div>
                        </div>
                        <span id="progressText" class="progress-text">0%</span>
                    </div>
                </div>

                <!-- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã -->
                <div class="uploaded-files">
                    <h3><i class="fas fa-folder-open"></i> –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</h3>
                    <div id="filesList" class="files-list">
                        <p class="empty-message"><i class="fas fa-inbox"></i> –§–∞–π–ª—ã –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</p>
                    </div>
                </div>
            </section>

            <!-- –°–µ–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö -->
            <section class="card">
                <h2><i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–∏ –¥–∞–Ω–Ω—ã–µ</h2>
                <div class="save-controls">
                    <button onclick="saveAllData()" class="save-btn">
                        <i class="fas fa-download"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ
                    </button>
                    <button onclick="exportData()" class="export-btn">
                        <i class="fas fa-file-export"></i> –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
                    </button>
                    <button onclick="clearAllData()" class="danger-btn">
                        <i class="fas fa-trash-alt"></i> –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                    </button>
                </div>
                <div class="data-info">
                    <p><i class="fas fa-info-circle"></i> –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</p>
                    <p id="storageUsage">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–∞–º—è—Ç–∏: 0 KB</p>
                </div>
            </section>
        </div>

        <footer>
            <p><i class="fas fa-info-circle"></i> –≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –¥–æ—Å—Ç—É–ø–Ω—ã–µ —á–µ—Ä–µ–∑ –≤–∞—à –±—Ä–∞—É–∑–µ—Ä –∏ Telegram Web App</p>
            <p class="timestamp" id="lastUpdate"></p>
        </footer>
    </div>

    <div id="toastContainer"></div>

    <script>
        // ===================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====================
        let userData = {
            deviceInfo: {},
            locationInfo: {},
            networkInfo: {},
            techInfo: {},
            telegramData: {},
            uploadedFiles: [],
            timestamps: {}
        };

        let selectedFiles = [];
        let tgWebApp = null;
        let locationWatchId = null;

        // ===================== –û–°–ù–û–í–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ –î–∞—à–±–æ—Ä–¥ –∑–∞–ø—É—â–µ–Ω!');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–∫—Ä—ã—Ç–æ –ª–∏ –≤ Telegram Web App
            detectTelegramWebApp();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
            updateTimestamp();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            loadSavedData();
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            collectDeviceData();
            
            // –°–æ–±–∏—Ä–∞–µ–º –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            initLocationServices();
            
            // –°–æ–±–∏—Ä–∞–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
            collectTechData();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—É–∫–∏
            checkCookies();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª—ã
            loadFiles();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª–∏
            setupEventListeners();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞–º—è—Ç–∏
            updateStorageInfo();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            setInterval(autoRefreshData, 30000);
            setInterval(updateTime, 1000);
        });

        // ===================== TELEGRAM WEB APP =====================
        function detectTelegramWebApp() {
            try {
                if (window.Telegram && window.Telegram.WebApp) {
                    tgWebApp = window.Telegram.WebApp;
                    console.log('üì± Telegram Web App –æ–±–Ω–∞—Ä—É–∂–µ–Ω!', tgWebApp);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é Telegram
                    document.getElementById('tgSection').classList.remove('hidden');
                    document.getElementById('tgBadge').classList.remove('hidden');
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram Web App
                    tgWebApp.ready();
                    tgWebApp.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
                    
                    // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Telegram
                    collectTelegramData();
                    
                    showToast('‚úÖ Telegram Web App –ø–æ–¥–∫–ª—é—á–µ–Ω', 'success');
                    return true;
                } else {
                    console.log('Telegram Web App –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
                    return false;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Telegram Web App:', error);
                return false;
            }
        }

        function collectTelegramData() {
            if (!tgWebApp) return;
            
            try {
                // –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const user = tgWebApp.initDataUnsafe.user;
                const initData = tgWebApp.initData;
                
                if (user) {
                    document.getElementById('tgUserId').textContent = user.id || '–ù–µ —É–∫–∞–∑–∞–Ω';
                    document.getElementById('tgUsername').textContent = user.username ? '@' + user.username : '–ù–µ —É–∫–∞–∑–∞–Ω';
                    document.getElementById('tgFullName').textContent = 
                        `${user.first_name || ''} ${user.last_name || ''}`.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    document.getElementById('tgLanguage').textContent = user.language_code || '–ù–µ —É–∫–∞–∑–∞–Ω';
                    
                    userData.telegramData.user = {
                        id: user.id,
                        username: user.username,
                        firstName: user.first_name,
                        lastName: user.last_name,
                        languageCode: user.language_code,
                        isPremium: user.is_premium || false
                    };
                }
                
                // –î–∞–Ω–Ω—ã–µ –æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
                document.getElementById('tgPlatform').textContent = tgWebApp.platform || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                document.getElementById('tgAppVersion').textContent = tgWebApp.version || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                
                // Init Data
                document.getElementById('tgInitData').textContent = 
                    initData ? '–ï—Å—Ç—å ‚úì' : '–ù–µ—Ç ‚úó';
                document.getElementById('tgHash').textContent = 
                    tgWebApp.initDataUnsafe.hash ? tgWebApp.initDataUnsafe.hash.substring(0, 20) + '...' : '–ù–µ—Ç';
                
                userData.telegramData.platform = tgWebApp.platform;
                userData.telegramData.version = tgWebApp.version;
                userData.telegramData.themeParams = tgWebApp.themeParams;
                userData.telegramData.initData = initData;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –µ—Å—Ç—å
                if (tgWebApp.initDataUnsafe.chat) {
                    userData.telegramData.chat = tgWebApp.initDataUnsafe.chat;
                }
                
                if (tgWebApp.initDataUnsafe.chat_type) {
                    userData.telegramData.chatType = tgWebApp.initDataUnsafe.chat_type;
                }
                
                if (tgWebApp.initDataUnsafe.chat_instance) {
                    userData.telegramData.chatInstance = tgWebApp.initDataUnsafe.chat_instance;
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
                saveAllData();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö Telegram:', error);
                showToast('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö Telegram', 'error');
            }
        }

        // ===================== –ì–ï–û–õ–û–ö–ê–¶–ò–Ø =====================
        function initLocationServices() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
            if (!navigator.geolocation) {
                showToast('‚ö†Ô∏è –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º', 'warning');
                document.getElementById('permissionRequest').classList.add('hidden');
                getApproximateLocation();
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
            document.getElementById('permissionRequest').classList.remove('hidden');
            
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ IP
            getApproximateLocation();
        }

        function requestLocationPermission() {
            if (!navigator.geolocation) {
                showToast('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
                return;
            }
            
            showToast('üîÑ –ó–∞–ø—Ä–∞—à–∏–≤–∞—é –¥–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏...', 'info');
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    // –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∏–ª–∏ —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
                    showToast('‚úÖ –î–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω', 'success');
                    document.getElementById('permissionRequest').classList.add('hidden');
                    updateExactLocation(position);
                    
                    // –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
                    startLocationTracking();
                },
                function(error) {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–∞–ª –∏–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
                    let errorMessage = '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: ';
                    
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage += '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º';
                            showToast('‚ùå –î–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage += '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞';
                            showToast('‚ö†Ô∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞', 'warning');
                            break;
                        case error.TIMEOUT:
                            errorMessage += '–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ';
                            showToast('‚è±Ô∏è –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ', 'warning');
                            break;
                        default:
                            errorMessage += '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
                            showToast('‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏', 'error');
                    }
                    
                    console.error(errorMessage);
                    getApproximateLocation(); // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        }

        function getExactLocation() {
            if (!navigator.geolocation) {
                showToast('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
                return;
            }
            
            showToast('üîÑ –ü–æ–ª—É—á–∞—é —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ...', 'info');
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    updateExactLocation(position);
                    showToast('‚úÖ –¢–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ', 'success');
                },
                function(error) {
                    showToast('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ', 'error');
                    console.error('–û—à–∏–±–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏:', error);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 15000,
                    maximumAge: 0
                }
            );
        }

        function updateExactLocation(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            const accuracy = position.coords.accuracy;
            const altitude = position.coords.altitude;
            const speed = position.coords.speed;
            const heading = position.coords.heading;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('coordinates').textContent = 
                `${latitude.toFixed(6)}, ${longitude.toFixed(6)}`;
            document.getElementById('accuracy').textContent = 
                `¬±${Math.round(accuracy)} –º–µ—Ç—Ä–æ–≤`;
            
            // –ü–æ–ª—É—á–∞–µ–º –∞–¥—Ä–µ—Å –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º (–æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)
            getAddressFromCoordinates(latitude, longitude);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            userData.locationInfo.exact = {
                latitude: latitude,
                longitude: longitude,
                accuracy: accuracy,
                altitude: altitude,
                speed: speed,
                heading: heading,
                timestamp: new Date(position.timestamp).toISOString()
            };
            
            saveAllData();
        }

        function startLocationTracking() {
            if (locationWatchId) {
                navigator.geolocation.clearWatch(locationWatchId);
            }
            
            locationWatchId = navigator.geolocation.watchPosition(
                function(position) {
                    updateExactLocation(position);
                },
                function(error) {
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è:', error);
                },
                {
                    enableHighAccuracy: true,
                    maximumAge: 10000,
                    timeout: 15000
                }
            );
        }

        async function getApproximateLocation() {
            showToast('üîÑ –ü–æ–ª—É—á–∞—é –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ IP...', 'info');
            
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–∏—Å –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å CORS
                const response = await fetch('https://ipapi.co/json/', {
                    mode: 'cors',
                    headers: { 'Accept': 'application/json' }
                });
                
                if (!response.ok) throw new Error('API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª');
                
                const data = await response.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                document.getElementById('ipLocation').textContent = 
                    `${data.city || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}, ${data.country_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}`;
                document.getElementById('isp').textContent = 
                    data.org || data.asn || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                if (data.latitude && data.longitude) {
                    document.getElementById('coordinates').textContent = 
                        `${data.latitude}, ${data.longitude}`;
                    document.getElementById('accuracy').textContent = 
                        '–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ (–ø–æ IP)';
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    userData.locationInfo.approximate = {
                        city: data.city,
                        region: data.region,
                        country: data.country_name,
                        latitude: data.latitude,
                        longitude: data.longitude,
                        isp: data.org,
                        ip: data.ip
                    };
                    
                    saveAllData();
                }
                
                // –¢–∞–∫–∂–µ –ø–æ–ª—É—á–∞–µ–º IP –∞–¥—Ä–µ—Å
                document.getElementById('ip').textContent = data.ip;
                userData.networkInfo.ip = data.ip;
                
                showToast('‚úÖ –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ', 'success');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ IP:', error);
                
                // –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å
                try {
                    const altResponse = await fetch('https://ipinfo.io/json', {
                        mode: 'cors',
                        headers: { 'Accept': 'application/json' }
                    });
                    
                    if (altResponse.ok) {
                        const altData = await altResponse.json();
                        const [city, country] = altData.loc ? altData.loc.split(',') : ['–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'];
                        
                        document.getElementById('ipLocation').textContent = 
                            `${altData.city || city}, ${altData.country || country}`;
                        document.getElementById('isp').textContent = 
                            altData.org || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                        document.getElementById('ip').textContent = altData.ip;
                        
                        showToast('‚úÖ –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥)', 'success');
                    } else {
                        throw new Error('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª');
                    }
                } catch (altError) {
                    document.getElementById('ipLocation').textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å';
                    document.getElementById('isp').textContent = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                    showToast('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ', 'error');
                }
            }
        }

        async function getAddressFromCoordinates(lat, lon) {
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º Nominatim (OpenStreetMap) - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–∞
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=18&addressdetails=1`,
                    {
                        headers: {
                            'Accept': 'application/json',
                            'Accept-Language': 'ru'
                        }
                    }
                );
                
                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.display_name) {
                        const address = data.display_name.split(',').slice(0, 3).join(',');
                        document.getElementById('exactLocation').innerHTML = 
                            `<span class="success"><i class="fas fa-check-circle"></i> ${address}</span>`;
                        
                        userData.locationInfo.address = data.display_name;
                        saveAllData();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞:', error);
                document.getElementById('exactLocation').innerHTML = 
                    '<span class="success"><i class="fas fa-check-circle"></i> –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã, –∞–¥—Ä–µ—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</span>';
            }
        }

        // ===================== –î–ê–ù–ù–´–ï –£–°–¢–†–û–ô–°–¢–í–ê =====================
        function collectDeviceData() {
            const userAgent = navigator.userAgent;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –±—Ä–∞—É–∑–µ—Ä
            let browser = detectBrowser(userAgent);
            document.getElementById('browser').textContent = browser;
            userData.deviceInfo.browser = browser;

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –û–°
            let os = detectOS(userAgent);
            document.getElementById('os').textContent = os;
            userData.deviceInfo.os = os;

            // –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
            const screenRes = `${window.screen.width} √ó ${window.screen.height} (${window.devicePixelRatio}x)`;
            document.getElementById('screen').textContent = screenRes;
            userData.deviceInfo.screen = screenRes;
            userData.deviceInfo.devicePixelRatio = window.devicePixelRatio;

            // –Ø–∑—ã–∫
            const languages = navigator.languages || [navigator.language];
            document.getElementById('language').textContent = languages.join(', ');
            userData.deviceInfo.languages = languages;

            // –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            document.getElementById('timezone').textContent = timezone;
            userData.deviceInfo.timezone = timezone;

            // User Agent
            document.getElementById('userAgent').textContent = userAgent;
            userData.deviceInfo.userAgent = userAgent;

            // –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
            document.getElementById('platform').textContent = navigator.platform;
            userData.deviceInfo.platform = navigator.platform;
        }

        function detectBrowser(ua) {
            if (ua.includes("Chrome") && !ua.includes("Edg") && !ua.includes("OPR")) return "Chrome";
            if (ua.includes("Firefox")) return "Firefox";
            if (ua.includes("Safari") && !ua.includes("Chrome")) return "Safari";
            if (ua.includes("Edg")) return "Edge";
            if (ua.includes("OPR") || ua.includes("Opera")) return "Opera";
            if (ua.includes("YaBrowser")) return "Yandex Browser";
            if (ua.includes("Instagram")) return "Instagram Browser";
            if (ua.includes("FBAN") || ua.includes("FBAV")) return "Facebook Browser";
            return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä";
        }

        function detectOS(ua) {
            if (ua.includes("Windows")) return "Windows";
            if (ua.includes("Mac")) return "macOS";
            if (ua.includes("Linux")) return "Linux";
            if (ua.includes("Android")) return "Android";
            if (ua.includes("iOS") || ua.includes("iPhone") || ua.includes("iPad")) return "iOS";
            if (ua.includes("CrOS")) return "Chrome OS";
            return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –û–°";
        }

        // ===================== –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï =====================
        function collectTechData() {
            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
            if (navigator.hardwareConcurrency) {
                document.getElementById('cpuCores').textContent = 
                    `${navigator.hardwareConcurrency} —è–¥–µ—Ä`;
                userData.techInfo.cpuCores = navigator.hardwareConcurrency;
            }

            // –ü–∞–º—è—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            if (navigator.deviceMemory) {
                document.getElementById('memory').textContent = 
                    `${navigator.deviceMemory} GB`;
                userData.techInfo.memory = navigator.deviceMemory;
            }

            // WebGL –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            const webglInfo = getWebGLInfo();
            document.getElementById('webgl').textContent = webglInfo;
            userData.techInfo.webgl = webglInfo;

            // –ë–∞—Ç–∞—Ä–µ—è
            if ('getBattery' in navigator) {
                navigator.getBattery().then(battery => {
                    const batteryInfo = `${Math.round(battery.level * 100)}% ${battery.charging ? '‚ö°' : ''}`;
                    document.getElementById('battery').textContent = batteryInfo;
                    userData.techInfo.battery = {
                        level: battery.level,
                        charging: battery.charging,
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime
                    };
                });
            }

            // –î–æ—Å—Ç—É–ø–Ω—ã–µ API
            const availableApis = detectAvailableAPIs();
            document.getElementById('availableApis').textContent = 
                `${availableApis.length} API –¥–æ—Å—Ç—É–ø–Ω–æ`;
            userData.techInfo.availableAPIs = availableApis;

            // –¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            if (navigator.connection) {
                const conn = navigator.connection;
                const type = conn.effectiveType || 'unknown';
                document.getElementById('connectionType').textContent = 
                    `${type} (${conn.downlink || '?'} Mbps, ${conn.rtt || '?'} ms)`;
                userData.networkInfo.connection = {
                    type: type,
                    downlink: conn.downlink,
                    rtt: conn.rtt,
                    saveData: conn.saveData
                };
            }

            // –û–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å
            const online = navigator.onLine;
            document.getElementById('onlineStatus').textContent = 
                online ? "–û–Ω–ª–∞–π–Ω ‚úì" : "–û—Ñ—Ñ–ª–∞–π–Ω ‚úó";
            document.getElementById('onlineStatus').className = 
                online ? "value success" : "value error";
            userData.networkInfo.online = online;

            // –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            if (performance.timing) {
                const loadTime = performance.timing.domContentLoadedEventEnd - 
                               performance.timing.navigationStart;
                document.getElementById('pageLoadTime').textContent = 
                    `${loadTime} –º—Å`;
                userData.networkInfo.pageLoadTime = loadTime;
            }
        }

        function getWebGLInfo() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                
                if (!gl) return '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
                
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if (debugInfo) {
                    const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                    const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
                    return `–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (${vendor.substring(0, 20)}...)`;
                }
                return '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
            } catch (e) {
                return '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏';
            }
        }

        function detectAvailableAPIs() {
            const apis = [];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ API
            const apiTests = [
                { name: 'Geolocation', test: 'geolocation' in navigator },
                { name: 'LocalStorage', test: 'localStorage' in window },
                { name: 'SessionStorage', test: 'sessionStorage' in window },
                { name: 'IndexedDB', test: 'indexedDB' in window },
                { name: 'ServiceWorker', test: 'serviceWorker' in navigator },
                { name: 'PushManager', test: 'PushManager' in window },
                { name: 'Notifications', test: 'Notification' in window },
                { name: 'WebRTC', test: 'RTCPeerConnection' in window },
                { name: 'WebSocket', test: 'WebSocket' in window },
                { name: 'WebGL', test: 'WebGLRenderingContext' in window },
                { name: 'WebAudio', test: 'AudioContext' in window },
                { name: 'SpeechRecognition', test: 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window },
                { name: 'SpeechSynthesis', test: 'speechSynthesis' in window },
                { name: 'PaymentRequest', test: 'PaymentRequest' in window },
                { name: 'Credential', test: 'CredentialsContainer' in navigator },
                { name: 'Bluetooth', test: 'bluetooth' in navigator },
                { name: 'USB', test: 'usb' in navigator },
                { name: 'Gamepad', test: 'getGamepads' in navigator },
                { name: 'Vibration', test: 'vibrate' in navigator },
                { name: 'Battery', test: 'getBattery' in navigator },
                { name: 'Network', test: 'connection' in navigator },
                { name: 'Storage', test: 'storage' in navigator && 'estimate' in navigator.storage },
                { name: 'Clipboard', test: 'clipboard' in navigator },
                { name: 'MediaDevices', test: 'mediaDevices' in navigator },
                { name: 'WakeLock', test: 'wakeLock' in navigator }
            ];
            
            apiTests.forEach(api => {
                if (api.test) apis.push(api.name);
            });
            
            return apis;
        }

        // ===================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====================
        function updateTimestamp() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            document.getElementById('lastUpdate').textContent = 
                `–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${now.toLocaleDateString('ru-RU', options)}`;
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = 
                now.toLocaleTimeString('ru-RU');
        }

        function checkCookies() {
            const cookiesEnabled = navigator.cookieEnabled;
            document.getElementById('cookies').textContent = 
                cookiesEnabled ? "–î–∞ ‚úì" : "–ù–µ—Ç ‚úó";
            document.getElementById('cookies').className = 
                cookiesEnabled ? "value success" : "value error";
            userData.deviceInfo.cookies = cookiesEnabled;
        }

        function setupEventListeners() {
            const fileInput = document.getElementById('fileInput');
            
            fileInput.addEventListener('change', function(e) {
                selectedFiles = Array.from(e.target.files);
                
                if (selectedFiles.length > 0) {
                    showToast(`üìÑ –í—ã–±—Ä–∞–Ω–æ ${selectedFiles.length} —Ñ–∞–π–ª(–æ–≤)`, 'info');
                }
            });
            
            // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞
            window.addEventListener('online', () => {
                document.getElementById('onlineStatus').textContent = "–û–Ω–ª–∞–π–Ω ‚úì";
                document.getElementById('onlineStatus').className = "value success";
                showToast('üåê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', 'success');
            });
            
            window.addEventListener('offline', () => {
                document.getElementById('onlineStatus').textContent = "–û—Ñ—Ñ–ª–∞–π–Ω ‚úó";
                document.getElementById('onlineStatus').className = "value error";
                showToast('‚ö†Ô∏è –ü–æ—Ç–µ—Ä—è–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É', 'warning');
            });
        }

        function autoRefreshData() {
            updateTimestamp();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ—Ç–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –æ–Ω–ª–∞–π–Ω
            if (navigator.onLine) {
                getApproximateLocation();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞—Ç–∞—Ä–µ—é –µ—Å–ª–∏ –µ—Å—Ç—å
            if ('getBattery' in navigator) {
                navigator.getBattery().then(battery => {
                    const batteryInfo = `${Math.round(battery.level * 100)}% ${battery.charging ? '‚ö°' : ''}`;
                    document.getElementById('battery').textContent = batteryInfo;
                });
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
            updateStorageInfo();
        }

        // ===================== –†–ê–ë–û–¢–ê –° –§–ê–ô–õ–ê–ú–ò =====================
        async function uploadFiles() {
            if (selectedFiles.length === 0) {
                showToast('‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã', 'warning');
                return;
            }

            const progressContainer = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            progressContainer.classList.remove('hidden');
            
            for (let i = 0; i < selectedFiles.length; i++) {
                const file = selectedFiles[i];
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                const progress = ((i + 1) / selectedFiles.length) * 100;
                progressFill.style.width = `${progress}%`;
                progressText.textContent = `${Math.round(progress)}%`;
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                await simulateUpload(file);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
                const fileInfo = {
                    id: Date.now() + i,
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    lastModified: file.lastModified,
                    uploadDate: new Date().toISOString(),
                    data: await readFileAsDataURL(file)
                };
                
                userData.uploadedFiles.push(fileInfo);
                saveFilesToStorage();
            }
            
            showToast(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${selectedFiles.length} —Ñ–∞–π–ª(–æ–≤)`, 'success');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            setTimeout(() => {
                progressContainer.classList.add('hidden');
                progressFill.style.width = '0%';
                progressText.textContent = '0%';
                document.getElementById('fileInput').value = '';
                selectedFiles = [];
                loadFiles();
            }, 1000);
        }

        function simulateUpload(file) {
            return new Promise(resolve => {
                setTimeout(() => {
                    console.log(`–§–∞–π–ª "${file.name}" –∑–∞–≥—Ä—É–∂–µ–Ω`);
                    resolve();
                }, 300);
            });
        }

        function readFileAsDataURL(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    resolve(e.target.result);
                };
                reader.readAsDataURL(file);
            });
        }

        function saveFilesToStorage() {
            try {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤
                const filesMetadata = userData.uploadedFiles.map(file => ({
                    id: file.id,
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    uploadDate: file.uploadDate
                }));
                
                localStorage.setItem('filesMetadata', JSON.stringify(filesMetadata));
                updateStorageInfo();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:', error);
            }
        }

        function loadFiles() {
            try {
                const filesList = document.getElementById('filesList');
                const savedMetadata = localStorage.getItem('filesMetadata');
                
                if (!savedMetadata || JSON.parse(savedMetadata).length === 0) {
                    filesList.innerHTML = '<p class="empty-message"><i class="fas fa-inbox"></i> –§–∞–π–ª—ã –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</p>';
                    return;
                }
                
                const files = JSON.parse(savedMetadata);
                filesList.innerHTML = files.map(file => `
                    <div class="file-item">
                        <div class="file-info">
                            <span class="file-icon">${getFileIcon(file.type)}</span>
                            <div>
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${formatFileSize(file.size)} ‚Ä¢ ${new Date(file.uploadDate).toLocaleDateString('ru-RU')}</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button onclick="downloadFile('${file.id}')" class="action-btn" title="–°–∫–∞—á–∞—Ç—å">
                                <i class="fas fa-download"></i>
                            </button>
                            <button onclick="deleteFile('${file.id}')" class="action-btn delete" title="–£–¥–∞–ª–∏—Ç—å">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤:', error);
            }
        }

        function getFileIcon(fileType) {
            if (fileType.includes('image')) return 'üñºÔ∏è';
            if (fileType.includes('video')) return 'üé¨';
            if (fileType.includes('audio')) return 'üéµ';
            if (fileType.includes('pdf')) return 'üìï';
            if (fileType.includes('text') || fileType.includes('document')) return 'üìÑ';
            if (fileType.includes('zip') || fileType.includes('compressed')) return 'üì¶';
            return 'üìÅ';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function downloadFile(fileId) {
            const file = userData.uploadedFiles.find(f => f.id === parseInt(fileId));
            if (file && file.data) {
                const link = document.createElement('a');
                link.href = file.data;
                link.download = file.name;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showToast(`üì• –§–∞–π–ª "${file.name}" —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è`, 'success');
            }
        }

        function deleteFile(fileId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª?')) {
                userData.uploadedFiles = userData.uploadedFiles.filter(f => f.id !== parseInt(fileId));
                saveFilesToStorage();
                loadFiles();
                showToast('üóëÔ∏è –§–∞–π–ª —É–¥–∞–ª–µ–Ω', 'info');
            }
        }

        function clearFiles() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤?')) {
                selectedFiles = [];
                document.getElementById('fileInput').value = '';
                showToast('üóëÔ∏è –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –æ—á–∏—â–µ–Ω', 'info');
            }
        }

        // ===================== –°–û–•–†–ê–ù–ï–ù–ò–ï –ò –≠–ö–°–ü–û–†–¢ =====================
        function saveAllData() {
            try {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
                userData.timestamps.lastUpdate = new Date().toISOString();
                userData.timestamps.firstVisit = userData.timestamps.firstVisit || new Date().toISOString();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                localStorage.setItem('userDashboardData', JSON.stringify(userData));
                
                // –û—Ç–¥–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤
                const filesMetadata = userData.uploadedFiles.map(file => ({
                    id: file.id,
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    uploadDate: file.uploadDate
                }));
                localStorage.setItem('filesMetadata', JSON.stringify(filesMetadata));
                
                showToast('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
                updateStorageInfo();
            } catch (error) {
                showToast('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            }
        }

        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('userDashboardData');
                const savedFiles = localStorage.getItem('filesMetadata');
                
                if (savedData) {
                    userData = JSON.parse(savedData);
                    console.log('üìÅ –ó–∞–≥—Ä—É–∂–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                }
                
                if (savedFiles) {
                    const filesMetadata = JSON.parse(savedFiles);
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∞–π–ª—ã –∏–∑ metadata
                    userData.uploadedFiles = filesMetadata.map(file => ({
                        ...file,
                        data: null // –î–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    }));
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
            }
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                localStorage.clear();
                userData = {
                    deviceInfo: {},
                    locationInfo: {},
                    networkInfo: {},
                    techInfo: {},
                    telegramData: {},
                    uploadedFiles: [],
                    timestamps: {}
                };
                
                selectedFiles = [];
                document.getElementById('filesList').innerHTML = 
                    '<p class="empty-message"><i class="fas fa-inbox"></i> –§–∞–π–ª—ã –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</p>';
                
                showToast('üóëÔ∏è –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã', 'info');
                updateStorageInfo();
            }
        }

        function updateStorageInfo() {
            try {
                let totalSize = 0;
                
                for (let key in localStorage) {
                    if (localStorage.hasOwnProperty(key)) {
                        totalSize += localStorage[key].length * 2;
                    }
                }
                
                const sizeInKB = (totalSize / 1024).toFixed(2);
                document.getElementById('storageUsage').textContent = 
                    `–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–∞–º—è—Ç–∏: ${sizeInKB} KB`;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –ø–∞–º—è—Ç–∏:', error);
            }
        }

        function exportData() {
            // –°–æ–∑–¥–∞–µ–º –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
            const exportData = {
                ...userData,
                exportDate: new Date().toISOString(),
                version: '1.0',
                source: 'Personal Dashboard'
            };
            
            // –£–±–∏—Ä–∞–µ–º –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤
            exportData.uploadedFiles = exportData.uploadedFiles.map(file => ({
                id: file.id,
                name: file.name,
                size: file.size,
                type: file.type,
                uploadDate: file.uploadDate
                // –ù–µ –≤–∫–ª—é—á–∞–µ–º file.data —á—Ç–æ–±—ã —Ñ–∞–π–ª –Ω–µ –±—ã–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º
            }));
            
            // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º JSON —Ñ–∞–π–ª
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `my-personal-data-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showToast('üì§ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ JSON', 'success');
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            toast.style.backgroundColor = 
                type === 'success' ? '#4CAF50' : 
                type === 'error' ? '#f44336' : 
                type === 'warning' ? '#ff9800' : '#333';
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // ===================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–°–ï–• –î–ê–ù–ù–´–• =====================
        function refreshDeviceData() {
            document.querySelectorAll('#deviceData .value').forEach(el => {
                el.classList.add('loading');
            });
            
            setTimeout(() => {
                collectDeviceData();
                showToast('üì± –î–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
            }, 500);
        }

        function refreshTechData() {
            document.querySelectorAll('#techData .value').forEach(el => {
                el.classList.add('loading');
            });
            
            setTimeout(() => {
                collectTechData();
                showToast('‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
            }, 500);
        }

        function refreshNetworkData() {
            document.querySelectorAll('#locationData .value').forEach(el => {
                if (!el.querySelector('button')) {
                    el.classList.add('loading');
                }
            });
            
            setTimeout(async () => {
                getApproximateLocation();
                showToast('üåê –°–µ—Ç–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
            }, 500);
        }

        function refreshAllData() {
            refreshDeviceData();
            refreshNetworkData();
            refreshTechData();
            loadFiles();
            updateStorageInfo();
            showToast('üîÑ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        document.addEventListener('DOMContentLoaded', function() {
            const header = document.querySelector('header');
            const refreshAllBtn = document.createElement('button');
            refreshAllBtn.className = 'refresh-all-btn';
            refreshAllBtn.innerHTML = '<i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ';
            refreshAllBtn.onclick = refreshAllData;
            header.appendChild(refreshAllBtn);
        });
    </script>
</body>
</html>
